*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:#050b16;color:#fff;font-family:-apple-system,BlinkMacSystemFont,'SF Pro Text','Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;overflow:hidden}
#app{position:relative;width:100vw;height:100vh;min-height:100vh}
@supports (height: 100svh){#app{height:100svh;min-height:100svh}}
@supports (height: 100dvh){#app{height:100dvh;min-height:100dvh}}

/* INTRO */
#intro{position:absolute;inset:0;width:100%;height:100%;display:block;z-index:5;transition:opacity .8s ease}
#intro.hidden{opacity:0;pointer-events:none}
#intro #sunGroup{transform-origin:195px 560px} /* pivot для анимации солнца */

/* Пост-интро слои */
#space-wrapper{position:absolute;inset:0;overflow:hidden;z-index:1;touch-action:none;cursor:grab}
#space-wrapper.panning{cursor:grabbing}
#space{position:absolute;top:0;left:0;will-change:transform}
#bg,#fx{position:absolute;inset:0;width:100%;height:100%;display:block;pointer-events:none;z-index:1}
#stars-layer{position:absolute;inset:0;width:100%;height:100%;pointer-events:none;z-index:2}
.star{position:absolute;width:var(--size,12px);height:var(--size,12px);left:var(--x,50%);top:var(--y,50%);transform:translate(-50%,-50%);pointer-events:auto;border-radius:50%;background:
  radial-gradient(circle at 50% 50%,#fff 0%,rgba(255,255,255,.92) 35%,rgba(255,255,255,.3) 55%,rgba(140,170,255,0) 75%),
  radial-gradient(circle at 50% 50%,rgba(100,140,255,.28) 0%,rgba(100,140,255,0) 70%);
box-shadow:0 0 14px rgba(170,200,255,.75),0 0 32px rgba(120,160,255,.35);
animation:twinkle var(--tw,2.8s) ease-in-out infinite;cursor:pointer;border:none;appearance:none;outline:none}
.star:focus-visible{outline:2px solid rgba(255,255,255,.6);outline-offset:4px;box-shadow:0 0 20px rgba(170,200,255,.85),0 0 38px rgba(120,160,255,.55)}
.star::before,.star::after{content:'';position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);background:linear-gradient(90deg,rgba(255,255,255,0),rgba(255,255,255,.8),rgba(255,255,255,0));border-radius:999px;opacity:.85;filter:blur(.2px)}
.star::before{width:190%;height:28%}
.star::after{width:28%;height:190%;background:linear-gradient(0deg,rgba(255,255,255,0),rgba(255,255,255,.8),rgba(255,255,255,0))}
.star.visited{background:
  radial-gradient(circle at 50% 50%,#fff7fc 0%,rgba(255,238,247,.92) 35%,rgba(255,216,236,.34) 55%,rgba(255,188,222,0) 75%),
  radial-gradient(circle at 50% 50%,rgba(255,168,210,.28) 0%,rgba(255,168,210,0) 70%);
box-shadow:0 0 16px rgba(255,180,220,.75),0 0 32px rgba(255,160,210,.35)}
.star.visited::before{background:linear-gradient(90deg,rgba(255,192,220,0),rgba(255,220,236,.85),rgba(255,192,220,0))}
.star.visited::after{background:linear-gradient(0deg,rgba(255,192,220,0),rgba(255,220,236,.85),rgba(255,192,220,0))}
@keyframes twinkle{0%,100%{opacity:.65;scale:.96}50%{opacity:1;scale:1.18}}

/* Модалка */
#memory{position:absolute;inset:0;display:grid;place-items:center;backdrop-filter:blur(12px) saturate(115%);background:radial-gradient(1200px 800px at 50% 50%,rgba(24,34,56,.55),rgba(0,0,0,.75));transition:opacity .5s ease;z-index:10}
#memory.hidden{opacity:0;pointer-events:none}
.memory-frame{position:relative;max-width:min(92vw,720px);width:92vw;border-radius:20px;overflow:clip;background:linear-gradient(135deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.16);box-shadow:0 18px 60px rgba(0,0,0,.55),0 0 80px rgba(160,200,255,.25) inset;animation:cardIn 520ms cubic-bezier(.2,.8,.2,1) both}
@keyframes cardIn{from{opacity:0;transform:translateY(12px) scale(.98)}to{opacity:1;transform:translateY(0) scale(1)}}
.memory-frame img{width:100%;display:block;aspect-ratio:4/5;object-fit:cover;filter:contrast(1.05) saturate(1.02)}
.caption{padding:12px 16px 16px;font-size:14px;color:#e8efff;text-align:center;text-wrap:balance;background:linear-gradient(180deg,rgba(255,255,255,.03),transparent)}
.close{position:absolute;top:10px;right:10px;appearance:none;border:none;width:36px;height:36px;border-radius:50%;font-size:18px;color:#dfe8ff;background:rgba(10,16,28,.55);border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(8px);cursor:pointer;transition:transform .15s ease, background .2s}
.close:active{transform:scale(.96)}

/* Подсказка */
#hint{position:absolute;bottom:calc(env(safe-area-inset-bottom) + 20px);left:50%;transform:translateX(-50%);padding:10px 16px;border-radius:999px;font-size:14px;color:#e8edff;background:rgba(12,18,30,.55);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.12);box-shadow:0 8px 24px rgba(0,0,0,.35);z-index:6;opacity:0;transition:opacity .6s ease}
#hint.show{opacity:1}

/* Кнопка звука */
.audio-toggle{position:absolute;top:calc(env(safe-area-inset-top) + 16px);right:calc(env(safe-area-inset-right) + 16px);z-index:8;width:44px;height:44px;border-radius:50%;border:1px solid rgba(255,255,255,.22);background:rgba(10,16,28,.55);backdrop-filter:blur(10px);color:#e3ebff;font-size:20px;display:grid;place-items:center;cursor:pointer;transition:transform .2s ease,background .3s ease,box-shadow .3s ease;box-shadow:0 10px 28px rgba(0,0,0,.35)}
.audio-toggle.on{background:rgba(40,64,120,.6);box-shadow:0 12px 32px rgba(20,40,80,.45)}
.audio-toggle:focus-visible{outline:2px solid rgba(255,255,255,.65);outline-offset:3px}
.audio-toggle:active{transform:scale(.95)}
