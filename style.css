@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@500;600&family=Great+Vibes&family=Raleway:wght@400;500;600&display=swap');
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:#050b16;color:#fff;font-family:'Raleway',-apple-system,BlinkMacSystemFont,'SF Pro Text','Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;overflow:hidden}
#app{position:relative;width:100vw;height:100vh;min-height:100vh}
@supports (height: 100svh){#app{height:100svh;min-height:100svh}}
@supports (height: 100dvh){#app{height:100dvh;min-height:100dvh}}

/* INTRO */
#intro{position:absolute;inset:0;width:100%;height:100%;display:block;z-index:5;transition:opacity .9s ease;mix-blend-mode:normal}
#intro.hidden{opacity:0;pointer-events:none}
#intro #sunGroup{transform-origin:195px 560px} /* pivot для анимации солнца */
#intro #milkyWay{filter:url(#softBlur)}

.hero-copy{position:absolute;inset:auto 8vw calc(env(safe-area-inset-bottom) + 9vh) 8vw;z-index:7;pointer-events:none;text-align:center;display:flex;flex-direction:column;gap:1.1rem;max-width:min(640px,84vw);left:50%;transform:translateX(-50%)}
.hero-title{font-family:'Cinzel','Times New Roman',serif;font-weight:600;font-size:clamp(1.9rem,4.2vw,3.6rem);letter-spacing:.08em;text-transform:uppercase;color:#fff;line-height:1.2;background:linear-gradient(120deg,rgba(255,207,168,.95),rgba(255,102,140,.95) 38%,rgba(148,114,255,.98) 72%,rgba(90,72,210,.92));background-size:200% 200%;-webkit-background-clip:text;background-clip:text;color:transparent;animation:heroShimmer 18s ease-in-out infinite}
.hero-subtitle{font-weight:500;font-size:clamp(1.05rem,2.1vw,1.45rem);color:rgba(235,240,255,.92);text-shadow:0 8px 26px rgba(10,8,30,.68);letter-spacing:.04em}
.hero-signature{font-family:'Great Vibes',cursive;font-size:clamp(1.6rem,3.8vw,2.6rem);color:rgba(255,198,233,.92);text-shadow:0 12px 32px rgba(90,34,130,.42)}

@keyframes heroShimmer{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

/* Пост-интро слои */
#space-wrapper{position:absolute;inset:0;overflow:hidden;z-index:1;touch-action:none;cursor:grab}
#space-wrapper.panning{cursor:grabbing}
#space{position:absolute;top:0;left:0;will-change:transform;transform-origin:0 0}
#bg,#fx{position:absolute;inset:0;width:100%;height:100%;display:block;pointer-events:none;z-index:1}
#stars-layer{position:absolute;inset:0;width:100%;height:100%;pointer-events:none;z-index:2}
.star{position:absolute;width:var(--size,12px);height:var(--size,12px);left:var(--x,50%);top:var(--y,50%);transform:translate(-50%,-50%);pointer-events:auto;border-radius:50%;background:
  radial-gradient(circle at 50% 50%,#fff 0%,rgba(255,255,255,.92) 35%,rgba(255,255,255,.3) 55%,rgba(140,170,255,0) 75%),
  radial-gradient(circle at 50% 50%,rgba(100,140,255,.28) 0%,rgba(100,140,255,0) 70%);
box-shadow:0 0 14px rgba(170,200,255,.75),0 0 32px rgba(120,160,255,.35);
animation:twinkle var(--tw,2.8s) ease-in-out infinite;cursor:pointer;border:none;appearance:none;outline:none}
.star:focus-visible{outline:2px solid rgba(255,255,255,.6);outline-offset:4px;box-shadow:0 0 20px rgba(170,200,255,.85),0 0 38px rgba(120,160,255,.55)}
.star::before,.star::after{content:'';position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);background:linear-gradient(90deg,rgba(255,255,255,0),rgba(255,255,255,.8),rgba(255,255,255,0));border-radius:999px;opacity:.85;filter:blur(.2px)}
.star::before{width:190%;height:28%}
.star::after{width:28%;height:190%;background:linear-gradient(0deg,rgba(255,255,255,0),rgba(255,255,255,.8),rgba(255,255,255,0))}
.star.visited{background:
  radial-gradient(circle at 50% 50%,#ffe3f4 0%,#ff9fce 48%,rgba(255,116,188,0.38) 72%,rgba(255,116,188,0) 100%);
box-shadow:0 0 16px rgba(255,126,191,.8),0 0 34px rgba(255,114,185,.45)}
.star.visited::before{background:linear-gradient(90deg,rgba(255,158,205,0),rgba(255,158,205,.95),rgba(255,158,205,0))}
.star.visited::after{background:linear-gradient(0deg,rgba(255,158,205,0),rgba(255,158,205,.95),rgba(255,158,205,0))}
.star.heart-star{transform:translate(-50%,-50%) rotate(var(--heart-tilt,0deg));animation:twinkle var(--tw,2.8s) ease-in-out infinite,heartPulse 6.4s ease-in-out infinite;transition:left 2.8s cubic-bezier(.22,.68,.3,1),top 2.8s cubic-bezier(.22,.68,.3,1);box-shadow:0 0 26px rgba(255,144,213,.88),0 0 70px rgba(255,120,198,.46)}
.star.heart-star::before{opacity:.95}
.star.heart-star::after{opacity:.95}
@keyframes heartPulse{0%,100%{transform:translate(-50%,-50%) rotate(var(--heart-tilt,0deg)) scale(1.08);box-shadow:0 0 28px rgba(255,150,220,.9),0 0 90px rgba(255,130,206,.55)}50%{transform:translate(-50%,-50%) rotate(var(--heart-tilt,0deg)) scale(1.24);box-shadow:0 0 38px rgba(255,168,228,.98),0 0 120px rgba(255,146,214,.68)}}
#stars-layer.heart-mode{pointer-events:none}
#stars-layer.heart-mode .star{pointer-events:none}
.heart-outline{position:absolute;inset:0;width:100%;height:100%;pointer-events:none;z-index:1}
.heart-outline path{fill:none;stroke:#ff8fd8;stroke-width:2.6;stroke-linecap:round;stroke-linejoin:round;filter:drop-shadow(0 0 22px rgba(255,134,210,.52));transition:stroke-dashoffset 5.4s cubic-bezier(.35,.75,.2,1)}
.heart-outline path.draw{stroke:#ff9fdf}
.constellation-lines{position:absolute;inset:0;width:100%;height:100%;pointer-events:none;z-index:1}
.constellation-lines line{stroke:rgba(210,220,255,.85);stroke-width:1.8;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:8 18;filter:drop-shadow(0 0 6px rgba(180,200,255,.6));animation:constellationFlow var(--flow-duration,5s) linear infinite,constellationPulse var(--pulse-duration,3.6s) ease-in-out infinite}
@keyframes constellationFlow{0%{stroke-dashoffset:0}100%{stroke-dashoffset:-26}}
@keyframes constellationPulse{0%,100%{opacity:.55}50%{opacity:.92}}
@keyframes twinkle{0%,100%{opacity:.65;scale:.96}50%{opacity:1;scale:1.18}}

/* Модалка */
#memory{position:absolute;inset:0;display:grid;place-items:center;backdrop-filter:blur(12px) saturate(115%);background:radial-gradient(1200px 800px at 50% 50%,rgba(24,34,56,.55),rgba(0,0,0,.75));transition:opacity .5s ease;z-index:10}
#memory.hidden{opacity:0;pointer-events:none}
.memory-frame{position:relative;max-width:min(92vw,720px);width:92vw;border-radius:20px;overflow:clip;background:linear-gradient(135deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.16);box-shadow:0 18px 60px rgba(0,0,0,.55),0 0 80px rgba(160,200,255,.25) inset;animation:cardIn 520ms cubic-bezier(.2,.8,.2,1) both}
@keyframes cardIn{from{opacity:0;transform:translateY(12px) scale(.98)}to{opacity:1;transform:translateY(0) scale(1)}}
.memory-frame img{width:100%;display:block;aspect-ratio:4/5;object-fit:cover;filter:contrast(1.05) saturate(1.02)}
.caption{padding:12px 16px 16px;font-size:14px;color:#e8efff;text-align:center;text-wrap:balance;background:linear-gradient(180deg,rgba(255,255,255,.03),transparent)}
.close{position:absolute;top:10px;right:10px;appearance:none;border:none;width:36px;height:36px;border-radius:50%;font-size:18px;color:#dfe8ff;background:rgba(10,16,28,.55);border:1px solid rgba(255,255,255,.2);backdrop-filter:blur(8px);cursor:pointer;transition:transform .15s ease, background .2s}
.close:active{transform:scale(.96)}

/* Подсказка */
#hint{position:absolute;bottom:calc(env(safe-area-inset-bottom) + 20px);left:50%;transform:translateX(-50%);padding:10px 16px;border-radius:999px;font-size:14px;color:#e8edff;background:rgba(12,18,30,.55);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.12);box-shadow:0 8px 24px rgba(0,0,0,.35);z-index:6;opacity:0;transition:opacity .6s ease;text-align:center}
#hint.show{opacity:1}

/* Кнопка звука */
.audio-toggle{position:absolute;top:calc(env(safe-area-inset-top) + 16px);right:calc(env(safe-area-inset-right) + 16px);z-index:8;width:44px;height:44px;border-radius:50%;border:1px solid rgba(255,255,255,.22);background:rgba(10,16,28,.55);backdrop-filter:blur(10px);color:#e3ebff;font-size:20px;display:grid;place-items:center;cursor:pointer;transition:transform .2s ease,background .3s ease,box-shadow .3s ease;box-shadow:0 10px 28px rgba(0,0,0,.35)}
.audio-toggle.on{background:rgba(40,64,120,.6);box-shadow:0 12px 32px rgba(20,40,80,.45)}
.audio-toggle:focus-visible{outline:2px solid rgba(255,255,255,.65);outline-offset:3px}
.audio-toggle:active{transform:scale(.95)}

@media (max-width:768px){
  .hero-copy{left:50%;right:50%;transform:translate(-50%,0);gap:.95rem;bottom:calc(env(safe-area-inset-bottom) + 8vh)}
  .hero-subtitle{font-size:clamp(.98rem,3.6vw,1.2rem)}
}

@media (orientation:landscape) and (max-height:580px){
  .hero-copy{flex-direction:row;align-items:flex-end;justify-content:center;gap:1.4rem;bottom:calc(env(safe-area-inset-bottom) + 5vh)}
  .hero-subtitle{max-width:42ch;text-align:left}
  .hero-title{text-align:left}
}
